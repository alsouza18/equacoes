<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de EquaÃ§Ãµes - Portal Educacional</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            height: 100%;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh; /* Altura normal para nÃ£o criar espaÃ§o desnecessÃ¡rio */
        }

        .main-wrapper {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Indicador visual de scroll funcionando */
        .scroll-indicator {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            background: rgba(0, 255, 0, 0.8);
            color: white;
            border-radius: 5px;
            font-size: 12px;
            z-index: 10000;
        }

        .container {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 40px;
            margin: 20px 0;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .user-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .admin-buttons, .professor-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }

        .exercise-area {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            margin: 10px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* Sistema de Login - SEM position fixed */
        .login-overlay {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            min-height: 100vh;
        }

        .login-overlay.show {
            display: flex !important;
        }

        .login-container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            max-width: 450px;
            width: 90%;
            text-align: center;
        }

        .login-header h2 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.8rem;
        }

        .form-group {
            margin: 20px 0;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        /* Modais que nÃ£o interferem com scroll */
        .modal {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: flex-start;
            z-index: 1000;
            padding: 20px;
            min-height: 100vh;
        }

        .modal.show {
            display: flex !important;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 20px;
            width: 95%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            margin-top: 20px;
        }
    </style>
</head>
<body>
<div class="main-wrapper">
    <!-- Indicador Visual de Scroll -->
    <div class="scroll-indicator" id="scrollIndicator">Scroll: 0px</div>
    
    <!-- Sistema de Login -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-container">
            <div class="login-header">
                <h2>ğŸ” Acesso ao Sistema</h2>
                <p>Entre com suas credenciais</p>
            </div>
            
            <div class="form-group">
                <label for="userType">Tipo de UsuÃ¡rio:</label>
                <select id="userType">
                    <option value="student">ğŸ‘¨â€ğŸ“ Estudante</option>
                    <option value="professor">ğŸ‘¨â€ğŸ« Professor</option>
                    <option value="admin">ğŸ‘¨â€ğŸ’¼ Administrador</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="username">Nome de UsuÃ¡rio:</label>
                <input type="text" id="username" placeholder="Digite seu nome de usuÃ¡rio">
            </div>
            
            <div class="form-group">
                <label for="password">Senha:</label>
                <input type="password" id="password" placeholder="Digite sua senha">
            </div>
            
            <button class="btn" onclick="handleLogin()">ğŸš€ Entrar</button>
            <button class="btn" onclick="showRegisterModal()" style="background: #28a745;">ğŸ“ Cadastrar Professor</button>
            <button class="btn" onclick="showRecoveryModal()" style="background: #ffc107; color: #333;">ğŸ”‘ Recuperar Acesso</button>
        </div>
    </div>
    
    <div class="header">
        <h1>ğŸ§® Sistema de EquaÃ§Ãµes</h1>
        <p>Portal Educacional Completo</p>
    </div>

    <!-- Interface Principal (oculta inicialmente) -->
    <div id="mainInterface" style="display: none;">
        <div class="container">
            <div class="user-info" id="userInfo"></div>
            
            <div class="admin-buttons" id="adminButtons" style="display: none;">
                <button class="btn" onclick="showStudentModal()">ğŸ‘¥ Gerenciar Estudantes</button>
                <button class="btn" onclick="showProfessorModal()">ğŸ‘¨â€ğŸ« Gerenciar Professores</button>
                <button class="btn" onclick="showStatsModal()">ğŸ“Š EstatÃ­sticas</button>
                <button class="btn" onclick="showAccessModal()" style="background: #fd7e14;">ğŸ” Gerenciar Acessos</button>
            </div>
            
            <div class="professor-buttons" id="professorButtons" style="display: none;">
                <button class="btn" onclick="showStudentModal()">ğŸ‘¥ Ver Estudantes</button>
                <button class="btn" onclick="showStatsModal()">ğŸ“Š EstatÃ­sticas</button>
            </div>
            
            <div class="exercise-area">
                <h2>ğŸ§® ExercÃ­cios de EquaÃ§Ãµes</h2>
                <div id="exerciseContainer">
                    <button class="btn" onclick="generateExercise()">ğŸ² Gerar Novo ExercÃ­cio</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Cadastro de Professor -->
    <div class="modal" id="registerModal">
        <div class="modal-content">
            <h3>ğŸ“ Cadastro de Professor</h3>
            <div class="form-group">
                <label>Nome Completo:</label>
                <input type="text" id="regName" placeholder="Nome completo do professor">
            </div>
            <div class="form-group">
                <label>Nome de UsuÃ¡rio:</label>
                <input type="text" id="regUsername" placeholder="Nome de usuÃ¡rio Ãºnico">
            </div>
            <div class="form-group">
                <label>Senha:</label>
                <input type="password" id="regPassword" placeholder="Senha do professor">
            </div>
            <div class="form-group">
                <label>Ãrea de Ensino:</label>
                <input type="text" id="regArea" placeholder="Ex: MatemÃ¡tica, FÃ­sica">
            </div>
            <button class="btn" onclick="registerProfessor()">âœ… Cadastrar</button>
            <button class="btn" onclick="closeModal('registerModal')" style="background: #6c757d;">âŒ Cancelar</button>
        </div>
    </div>

    <!-- Modal de Estudantes -->
    <div class="modal" id="studentModal">
        <div class="modal-content">
            <h3>ğŸ‘¥ Gerenciar Estudantes</h3>
            <div id="studentList"></div>
            <button class="btn" onclick="closeModal('studentModal')" style="background: #6c757d;">âŒ Fechar</button>
        </div>
    </div>

    <!-- Modal de Professores -->
    <div class="modal" id="professorModal">
        <div class="modal-content">
            <h3>ğŸ‘¨â€ğŸ« Gerenciar Professores</h3>
            <div id="professorList"></div>
            <button class="btn" onclick="closeModal('professorModal')" style="background: #6c757d;">âŒ Fechar</button>
        </div>
    </div>

    <!-- Modal de EstatÃ­sticas -->
    <div class="modal" id="statsModal">
        <div class="modal-content">
            <h3>ğŸ“Š EstatÃ­sticas do Sistema</h3>
            <div id="statsContent"></div>
            <button class="btn" onclick="closeModal('statsModal')" style="background: #6c757d;">âŒ Fechar</button>
        </div>
    </div>

    <!-- Modal de RecuperaÃ§Ã£o de Acesso -->
    <div class="modal" id="recoveryModal">
        <div class="modal-content">
            <h3>ğŸ”‘ Recuperar Acesso</h3>
            <p>Digite seu nome de usuÃ¡rio para resetar sua senha:</p>
            <div class="form-group">
                <label>Tipo de UsuÃ¡rio:</label>
                <select id="recoveryUserType">
                    <option value="student">ğŸ‘¨â€ğŸ“ Estudante</option>
                    <option value="professor">ğŸ‘¨â€ğŸ« Professor</option>
                    <option value="admin">ğŸ‘¨â€ğŸ’¼ Administrador</option>
                </select>
            </div>
            <div class="form-group">
                <label>Nome de UsuÃ¡rio:</label>
                <input type="text" id="recoveryUsername" placeholder="Digite seu nome de usuÃ¡rio">
            </div>
            <div class="form-group">
                <label>Nova Senha:</label>
                <input type="password" id="recoveryNewPassword" placeholder="Digite a nova senha">
            </div>
            <button class="btn" onclick="recoverAccess()">ğŸ”“ Resetar Senha</button>
            <button class="btn" onclick="closeModal('recoveryModal')" style="background: #6c757d;">âŒ Cancelar</button>
        </div>
    </div>

    <!-- Modal de AlteraÃ§Ã£o de Senha -->
    <div class="modal" id="changePasswordModal">
        <div class="modal-content">
            <h3>ğŸ”’ Alterar Senha</h3>
            <div class="form-group">
                <label>Senha Atual:</label>
                <input type="password" id="currentPassword" placeholder="Digite sua senha atual">
            </div>
            <div class="form-group">
                <label>Nova Senha:</label>
                <input type="password" id="newPassword" placeholder="Digite a nova senha">
            </div>
            <div class="form-group">
                <label>Confirmar Nova Senha:</label>
                <input type="password" id="confirmPassword" placeholder="Confirme a nova senha">
            </div>
            <button class="btn" onclick="changePassword()">âœ… Alterar Senha</button>
            <button class="btn" onclick="closeModal('changePasswordModal')" style="background: #6c757d;">âŒ Cancelar</button>
        </div>
    </div>

    <!-- Modal de Gerenciar Acessos (Admin) -->
    <div class="modal" id="accessModal">
        <div class="modal-content">
            <h3>ğŸ” Gerenciar Acessos do Sistema</h3>
            <div id="accessContent"></div>
            <button class="btn" onclick="closeModal('accessModal')" style="background: #6c757d;">âŒ Fechar</button>
        </div>
    </div>

    <!-- Sistema JavaScript Educacional -->
    <script>
        // Dados salvos no localStorage
        let currentUser = null;
        
        // Inicializar dados padrÃ£o
        function initializeData() {
            if (!localStorage.getItem('equacoes_admins')) {
                localStorage.setItem('equacoes_admins', JSON.stringify([
                    { username: 'admin', password: 'admin123', name: 'Administrador' }
                ]));
            }
            if (!localStorage.getItem('equacoes_professors')) {
                localStorage.setItem('equacoes_professors', JSON.stringify([]));
            }
            if (!localStorage.getItem('equacoes_students')) {
                localStorage.setItem('equacoes_students', JSON.stringify([]));
            }
            if (!localStorage.getItem('equacoes_stats')) {
                localStorage.setItem('equacoes_stats', JSON.stringify({
                    totalExercises: 0,
                    correctAnswers: 0,
                    totalStudents: 0,
                    totalProfessors: 0
                }));
            }
        }
        
        // FunÃ§Ã£o de login
        function handleLogin() {
            const userType = document.getElementById('userType').value;
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (!username || !password) {
                alert('Por favor, preencha todos os campos!');
                return;
            }
            
            let users = [];
            let userTypeName = '';
            
            switch(userType) {
                case 'admin':
                    users = JSON.parse(localStorage.getItem('equacoes_admins') || '[]');
                    userTypeName = 'Administrador';
                    break;
                case 'professor':
                    users = JSON.parse(localStorage.getItem('equacoes_professors') || '[]');
                    userTypeName = 'Professor';
                    break;
                case 'student':
                    // Para estudantes, criar automaticamente se nÃ£o existir
                    users = JSON.parse(localStorage.getItem('equacoes_students') || '[]');
                    let student = users.find(u => u.username === username);
                    if (!student) {
                        student = {
                            username: username,
                            password: password,
                            name: username,
                            exercises: [],
                            score: 0
                        };
                        users.push(student);
                        localStorage.setItem('equacoes_students', JSON.stringify(users));
                    }
                    userTypeName = 'Estudante';
                    break;
            }
            
            const user = users.find(u => u.username === username && u.password === password);
            
            if (user) {
                currentUser = { ...user, type: userType };
                showMainInterface();
            } else {
                alert('Credenciais invÃ¡lidas!');
            }
        }
        
        // Mostrar interface principal
        function showMainInterface() {
            document.getElementById('loginOverlay').style.display = 'none';
            document.getElementById('mainInterface').style.display = 'block';
            
            const userInfo = document.getElementById('userInfo');
            userInfo.innerHTML = `
                <h3>Bem-vindo, ${currentUser.name}!</h3>
                <p>Tipo: ${currentUser.type === 'admin' ? 'Administrador' : 
                          currentUser.type === 'professor' ? 'Professor' : 'Estudante'}</p>
                <button class="btn" onclick="showChangePasswordModal()" style="background: #17a2b8;">ğŸ”’ Alterar Senha</button>
                <button class="btn" onclick="logout()" style="background: #dc3545;">ğŸšª Sair</button>
            `;
            
            // Mostrar botÃµes especÃ­ficos do tipo de usuÃ¡rio
            if (currentUser.type === 'admin') {
                document.getElementById('adminButtons').style.display = 'block';
            } else if (currentUser.type === 'professor') {
                document.getElementById('professorButtons').style.display = 'block';
            }
        }
        
        // Logout
        function logout() {
            currentUser = null;
            document.getElementById('loginOverlay').style.display = 'flex';
            document.getElementById('mainInterface').style.display = 'none';
            document.getElementById('adminButtons').style.display = 'none';
            document.getElementById('professorButtons').style.display = 'none';
        }
        
        // FunÃ§Ãµes de modal
        function showRegisterModal() {
            document.getElementById('registerModal').classList.add('show');
        }
        
        function showStudentModal() {
            const students = JSON.parse(localStorage.getItem('equacoes_students') || '[]');
            const list = document.getElementById('studentList');
            list.innerHTML = students.map(s => `
                <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 5px;">
                    <strong>${s.name}</strong> (@${s.username})<br>
                    ExercÃ­cios: ${s.exercises ? s.exercises.length : 0} | PontuaÃ§Ã£o: ${s.score || 0}
                </div>
            `).join('') || '<p>Nenhum estudante cadastrado.</p>';
            
            document.getElementById('studentModal').classList.add('show');
        }
        
        function showProfessorModal() {
            const professors = JSON.parse(localStorage.getItem('equacoes_professors') || '[]');
            const list = document.getElementById('professorList');
            list.innerHTML = professors.map(p => `
                <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 5px;">
                    <strong>${p.name}</strong> (@${p.username})<br>
                    Ãrea: ${p.area || 'NÃ£o especificada'}
                </div>
            `).join('') || '<p>Nenhum professor cadastrado.</p>';
            
            document.getElementById('professorModal').classList.add('show');
        }
        
        function showStatsModal() {
            const stats = JSON.parse(localStorage.getItem('equacoes_stats') || '{}');
            const students = JSON.parse(localStorage.getItem('equacoes_students') || '[]');
            const professors = JSON.parse(localStorage.getItem('equacoes_professors') || '[]');
            
            const content = document.getElementById('statsContent');
            content.innerHTML = `
                <div style="text-align: center;">
                    <h4>ğŸ“Š EstatÃ­sticas Gerais</h4>
                    <p>ğŸ‘¥ Total de Estudantes: ${students.length}</p>
                    <p>ğŸ‘¨â€ğŸ« Total de Professores: ${professors.length}</p>
                    <p>ğŸ§® ExercÃ­cios Resolvidos: ${stats.totalExercises || 0}</p>
                    <p>âœ… Respostas Corretas: ${stats.correctAnswers || 0}</p>
                    <p>ğŸ“ˆ Taxa de Acerto: ${stats.totalExercises > 0 ? 
                        Math.round((stats.correctAnswers / stats.totalExercises) * 100) : 0}%</p>
                </div>
            `;
            
            document.getElementById('statsModal').classList.add('show');
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }
        
        // === NOVAS FUNCIONALIDADES DE ACESSO ===
        
        // Mostrar modal de recuperaÃ§Ã£o de acesso
        function showRecoveryModal() {
            document.getElementById('recoveryModal').classList.add('show');
        }
        
        // Mostrar modal de alteraÃ§Ã£o de senha
        function showChangePasswordModal() {
            document.getElementById('changePasswordModal').classList.add('show');
        }
        
        // Mostrar modal de gerenciar acessos (admin)
        function showAccessModal() {
            const students = JSON.parse(localStorage.getItem('equacoes_students') || '[]');
            const professors = JSON.parse(localStorage.getItem('equacoes_professors') || '[]');
            const admins = JSON.parse(localStorage.getItem('equacoes_admins') || '[]');
            
            const content = document.getElementById('accessContent');
            content.innerHTML = `
                <div style="max-height: 400px; overflow-y: auto;">
                    <h4>ğŸ‘¨â€ğŸ’¼ Administradores</h4>
                    ${admins.map(u => `
                        <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 5px; background: #fff3cd;">
                            <strong>${u.name || u.username}</strong> (@${u.username})
                            <button class="btn" onclick="resetUserPassword('admin', '${u.username}')" style="background: #ffc107; color: #333; margin-left: 10px;">ğŸ”‘ Resetar Senha</button>
                        </div>
                    `).join('')}
                    
                    <h4>ğŸ‘¨â€ğŸ« Professores</h4>
                    ${professors.map(u => `
                        <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 5px; background: #d1ecf1;">
                            <strong>${u.name}</strong> (@${u.username}) - ${u.area || 'Ãrea nÃ£o especificada'}
                            <button class="btn" onclick="resetUserPassword('professor', '${u.username}')" style="background: #ffc107; color: #333; margin-left: 10px;">ğŸ”‘ Resetar Senha</button>
                            <button class="btn" onclick="deleteUser('professor', '${u.username}')" style="background: #dc3545; margin-left: 5px;">ğŸ—‘ï¸ Excluir</button>
                        </div>
                    `).join('')}
                    
                    <h4>ğŸ‘¨â€ğŸ“ Estudantes</h4>
                    ${students.map(u => `
                        <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 5px; background: #d4edda;">
                            <strong>${u.name}</strong> (@${u.username}) - Pontos: ${u.score || 0}
                            <button class="btn" onclick="resetUserPassword('student', '${u.username}')" style="background: #ffc107; color: #333; margin-left: 10px;">ğŸ”‘ Resetar Senha</button>
                            <button class="btn" onclick="deleteUser('student', '${u.username}')" style="background: #dc3545; margin-left: 5px;">ğŸ—‘ï¸ Excluir</button>
                        </div>
                    `).join('')}
                </div>
            `;
            
            document.getElementById('accessModal').classList.add('show');
        }
        
        // Recuperar acesso (resetar senha)
        function recoverAccess() {
            const userType = document.getElementById('recoveryUserType').value;
            const username = document.getElementById('recoveryUsername').value;
            const newPassword = document.getElementById('recoveryNewPassword').value;
            
            if (!username || !newPassword) {
                alert('Por favor, preencha todos os campos!');
                return;
            }
            
            const storageKey = `equacoes_${userType}s`;
            const users = JSON.parse(localStorage.getItem(storageKey) || '[]');
            const userIndex = users.findIndex(u => u.username === username);
            
            if (userIndex === -1) {
                alert('UsuÃ¡rio nÃ£o encontrado!');
                return;
            }
            
            users[userIndex].password = newPassword;
            localStorage.setItem(storageKey, JSON.stringify(users));
            
            alert('Senha resetada com sucesso! FaÃ§a login com a nova senha.');
            closeModal('recoveryModal');
            
            // Limpar campos
            document.getElementById('recoveryUsername').value = '';
            document.getElementById('recoveryNewPassword').value = '';
        }
        
        // Alterar senha do usuÃ¡rio logado
        function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (!currentPassword || !newPassword || !confirmPassword) {
                alert('Por favor, preencha todos os campos!');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                alert('A nova senha e a confirmaÃ§Ã£o devem ser iguais!');
                return;
            }
            
            if (currentPassword !== currentUser.password) {
                alert('Senha atual incorreta!');
                return;
            }
            
            // Atualizar senha no localStorage
            const storageKey = `equacoes_${currentUser.type}s`;
            const users = JSON.parse(localStorage.getItem(storageKey) || '[]');
            const userIndex = users.findIndex(u => u.username === currentUser.username);
            
            if (userIndex !== -1) {
                users[userIndex].password = newPassword;
                localStorage.setItem(storageKey, JSON.stringify(users));
                currentUser.password = newPassword; // Atualizar na sessÃ£o atual
                
                alert('Senha alterada com sucesso!');
                closeModal('changePasswordModal');
                
                // Limpar campos
                document.getElementById('currentPassword').value = '';
                document.getElementById('newPassword').value = '';
                document.getElementById('confirmPassword').value = '';
            } else {
                alert('Erro ao alterar senha!');
            }
        }
        
        // Resetar senha de usuÃ¡rio (funÃ§Ã£o admin)
        function resetUserPassword(userType, username) {
            const newPassword = prompt(`Digite a nova senha para ${username}:`);
            if (!newPassword) return;
            
            const storageKey = `equacoes_${userType}s`;
            const users = JSON.parse(localStorage.getItem(storageKey) || '[]');
            const userIndex = users.findIndex(u => u.username === username);
            
            if (userIndex !== -1) {
                users[userIndex].password = newPassword;
                localStorage.setItem(storageKey, JSON.stringify(users));
                alert(`Senha de ${username} alterada para: ${newPassword}`);
                showAccessModal(); // Atualizar a lista
            } else {
                alert('UsuÃ¡rio nÃ£o encontrado!');
            }
        }
        
        // Excluir usuÃ¡rio (funÃ§Ã£o admin)
        function deleteUser(userType, username) {
            if (!confirm(`Tem certeza que deseja excluir o usuÃ¡rio ${username}?`)) return;
            
            const storageKey = `equacoes_${userType}s`;
            const users = JSON.parse(localStorage.getItem(storageKey) || '[]');
            const filteredUsers = users.filter(u => u.username !== username);
            
            localStorage.setItem(storageKey, JSON.stringify(filteredUsers));
            alert(`UsuÃ¡rio ${username} excluÃ­do com sucesso!`);
            showAccessModal(); // Atualizar a lista
        }
        
        // Cadastrar professor
        function registerProfessor() {
            const name = document.getElementById('regName').value;
            const username = document.getElementById('regUsername').value;
            const password = document.getElementById('regPassword').value;
            const area = document.getElementById('regArea').value;
            
            if (!name || !username || !password) {
                alert('Preencha todos os campos obrigatÃ³rios!');
                return;
            }
            
            const professors = JSON.parse(localStorage.getItem('equacoes_professors') || '[]');
            
            if (professors.find(p => p.username === username)) {
                alert('Nome de usuÃ¡rio jÃ¡ existe!');
                return;
            }
            
            professors.push({ name, username, password, area });
            localStorage.setItem('equacoes_professors', JSON.stringify(professors));
            
            alert('Professor cadastrado com sucesso!');
            closeModal('registerModal');
            
            // Limpar campos
            document.getElementById('regName').value = '';
            document.getElementById('regUsername').value = '';
            document.getElementById('regPassword').value = '';
            document.getElementById('regArea').value = '';
        }
        
        // Gerar exercÃ­cio
        function generateExercise() {
            const a = Math.floor(Math.random() * 10) + 1;
            const b = Math.floor(Math.random() * 20) + 1;
            const x = Math.floor(Math.random() * 10) + 1;
            const result = a * x + b;
            
            const container = document.getElementById('exerciseContainer');
            container.innerHTML = `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                    <h3>Resolva a equaÃ§Ã£o:</h3>
                    <p style="font-size: 1.5rem; text-align: center; margin: 20px 0;">
                        ${a}x + ${b} = ${result}
                    </p>
                    <div>
                        <input type="number" id="answer" placeholder="Valor de x" style="padding: 10px; margin: 10px;">
                        <button class="btn" onclick="checkAnswer(${x})">âœ… Verificar</button>
                        <button class="btn" onclick="generateExercise()">ğŸ² Nova EquaÃ§Ã£o</button>
                    </div>
                    <div id="result"></div>
                </div>
            `;
        }
        
        // Verificar resposta
        function checkAnswer(correctAnswer) {
            const userAnswer = parseInt(document.getElementById('answer').value);
            const resultDiv = document.getElementById('result');
            
            if (userAnswer === correctAnswer) {
                resultDiv.innerHTML = '<p style="color: green; font-weight: bold;">ğŸ‰ Correto! ParabÃ©ns!</p>';
                updateStats(true);
            } else {
                resultDiv.innerHTML = `<p style="color: red; font-weight: bold;">âŒ Incorreto. A resposta Ã© x = ${correctAnswer}</p>`;
                updateStats(false);
            }
        }
        
        // Atualizar estatÃ­sticas
        function updateStats(isCorrect) {
            const stats = JSON.parse(localStorage.getItem('equacoes_stats') || '{}');
            stats.totalExercises = (stats.totalExercises || 0) + 1;
            if (isCorrect) {
                stats.correctAnswers = (stats.correctAnswers || 0) + 1;
            }
            localStorage.setItem('equacoes_stats', JSON.stringify(stats));
            
            // Atualizar pontuaÃ§Ã£o do usuÃ¡rio
            if (currentUser && currentUser.type === 'student') {
                const students = JSON.parse(localStorage.getItem('equacoes_students') || '[]');
                const student = students.find(s => s.username === currentUser.username);
                if (student) {
                    student.score = (student.score || 0) + (isCorrect ? 10 : 0);
                    if (!student.exercises) student.exercises = [];
                    student.exercises.push({
                        date: new Date().toISOString(),
                        correct: isCorrect
                    });
                    localStorage.setItem('equacoes_students', JSON.stringify(students));
                }
            }
        }
        
        // Inicializar ao carregar
        window.addEventListener('load', function() {
            initializeData();
            document.getElementById('loginOverlay').style.display = 'flex';
        });
    </script>

    <!-- Script de Teste de Scroll Funcional -->
    <script>
        // Teste de scroll em tempo real
        window.addEventListener('scroll', function() {
            const scrollIndicator = document.getElementById('scrollIndicator');
            if (scrollIndicator) {
                scrollIndicator.textContent = `Scroll: ${Math.round(window.pageYOffset)}px`;
            }
        });

        // Log para confirmar que o scroll estÃ¡ funcionando
        console.log('âœ… Sistema de scroll limpo inicializado');
        console.log('ğŸ“ Altura do documento:', document.body.scrollHeight);
        console.log('ğŸ“ Altura da viewport:', window.innerHeight);
        
        // Teste automÃ¡tico de scroll
        setTimeout(() => {
            console.log('ğŸ§ª Testando scroll automÃ¡tico...');
            window.scrollTo(0, 300);
            setTimeout(() => {
                const currentScroll = window.pageYOffset;
                console.log(currentScroll > 0 ? 'âœ… Scroll funcionando!' : 'âŒ Scroll travado!');
            }, 500);
        }, 2000);
    </script>
</div> <!-- Fim main-wrapper -->
</body>
</html>
